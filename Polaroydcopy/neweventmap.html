<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Polaroyd - Bootstrap Agency Template</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">
  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,300,700&subset=latin,cyrillic-ext" rel="stylesheet">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet">
  <link href="lib/fullpage-menu/fullpage-menu.css" rel="stylesheet">
  <link href="lib/cubeportfolio/cubeportfolio.css" rel="stylesheet">
  <link href="lib/superslides/superslides.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
    integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
    crossorigin=""></script>

</head>
</script>
<button type="button" class="btn btn-warning" onclick="show_marker();">Find Bookstores</button>
<br>
<div id="map" style="width:455px; height: 1200px; border: 1px solid #AAA;"></div>

<script>
var map = L.map('map').setView([30.6176262, 119], 9);;
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoieWVkZGEiLCJhIjoiY2pvZHg3OXVqMHVndzNrbGY5Y2hrYjgwMSJ9.LlDnLQBn5SMrS5IAVQDIPQ', {
  attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
  maxZoom: 18,
  id: 'mapbox.streets',
  accessToken: 'pk.eyJ1IjoieWVkZGEiLCJhIjoiY2pvZHg3OXVqMHVndzNrbGY5Y2hrYjgwMSJ9.LlDnLQBn5SMrS5IAVQDIPQ'
}).addTo(map);
var orangeIcon = L.icon({
    iconUrl: 'orange.png',
    iconSize:[70, 65], // size of the icon
});
var items = [];
var airtable_read_endpoint = "https://api.airtable.com/v0/appoetAbdYvggF71P/BookstoresFull?api_key=keyE2Q3CSRHLNZqT8";
var data1 = [];
$.getJSON(airtable_read_endpoint, function(result) {
       $.each(result.records, function(key,value) {
           items = {};
               items["name"] = value.fields.bookstore;
               items["image"] = value.fields.img_url;
               items["latitude"] = value.fields.latitude;
               items["longitude"] = value.fields.longitude;
               items["likes"] = value.fields.likes;
               items["url"] = value.fields.url;
               data1.push(items);
               console.log(items);
        }); // end .each
}); // end getJSON
</script>

<script>
function show_marker(){
  for (var i in data1) {
      var latlng = L.latLng({ lat: data1[i].latitude, lng: data1[i].longitude});
      var marker = L.marker(latlng,{icon:orangeIcon})
          .bindPopup( '<a href="' + data1[i].url + '" target="_blank">' + '<img src="' + data1[i].image+'" width = "150px"><br>'+data1[i].name +'<br>'+ '</a>'+data1[i].likes)
          .addTo(map);
  }
}
</script>

</body>
</html>



</script>
